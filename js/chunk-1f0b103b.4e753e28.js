(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f0b103b"],{"77da":function(t,e,n){"use strict";n("7f7f"),n("96cf");var r=n("1da1"),a=n("bee2"),i=n("99de"),s=n("7e84"),u=n("262e"),c=n("d4ec"),o=(n("cadf"),n("551c"),n("097d"),n("55dd"),n("39c6")),l=n("bff1"),h=n("f370"),d=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(i["a"])(this,Object(s["a"])(e).call(this,t)),Object(h["e"])(t)?(n.startTime=parseInt(t.start_time,10),n.status=t.status):(n.startTime=0,n.status=l["b"].Unknown),n}return Object(u["a"])(e,t),Object(a["a"])(e,[{key:"isActive",value:function(){return this.status===l["b"].Active}},{key:"canInsure",value:function(){return this.isActive()&&1===this.bankerCards.length&&this.bankerCards[0].isAce()}},{key:"canDouble",value:function(){return this.isActive()&&2===this.playerCards.length}}]),e}(l["a"]),f=function(t){function e(t,n){return Object(c["a"])(this,e),Object(i["a"])(this,Object(s["a"])(e).call(this,t,"games","player",n))}return Object(u["a"])(e,t),Object(a["a"])(e,[{key:"convert",value:function(t){return t.map(function(t){return new d(t)}).sort(function(t,e){return e.closeTime-t.closeTime})}}]),e}(o["a"]),k=n("47bb"),b=n("abdf"),y=n("292a"),v=function t(){Object(c["a"])(this,t)};v.NETWORK=y["a"].MAINNET;n("6b54");var p,g,m=n("6ebf"),w=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(i["a"])(this,Object(s["a"])(e).call(this,t)),n.payout=k["a"].fromString(t.payout),n}return Object(u["a"])(e,t),Object(a["a"])(e,[{key:"getResultString",value:function(){switch(this.result){case l["c"].Surrender:return m["a"].t("bj_result_surrender");case l["c"].Lose:return this.playerPoints>l["a"].MAX_POINTS?m["a"].t("bj_result_player_busted"):m["a"].t("bj_result_banker_win");case l["c"].Push:return m["a"].t("bj_result_push");case l["c"].Win:return this.isPlayerBlackjack()?m["a"].t("bj_result_player_blackjack"):this.bankerPoints>l["a"].MAX_POINTS?m["a"].t("bj_result_banker_busted"):m["a"].t("bj_result_player_win");default:throw new Error("Invalid Game Result")}}},{key:"getResultStringLang",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(this.result){case l["c"].Surrender:return t?"玩家投降":"Surrender";case l["c"].Lose:return this.playerPoints>l["a"].MAX_POINTS?t?"玩家爆牌":"Player Busted":t?"庄家赢":"Banker Win";case l["c"].Push:return t?"平局":"Push";case l["c"].Win:return this.isPlayerBlackjack()?t?"玩家黑杰克":"Player Blackjack":this.bankerPoints>l["a"].MAX_POINTS?t?"庄家爆牌":"Banker Busted":t?"玩家赢":"Player Win";default:throw new Error(t?"无效游戏结果":"Invalid Game Result")}}},{key:"toString",value:function(){return this.getResultString().toString()+" (".concat(this.playerPoints,":").concat(this.bankerPoints,")")}},{key:"hasEOSPayout",value:function(){return this.payout.quantity>0}}]),e}(l["a"]),O=function(t){function e(t,n){return Object(c["a"])(this,e),Object(i["a"])(this,Object(s["a"])(e).call(this,t,"results","id",n))}return Object(u["a"])(e,t),Object(a["a"])(e,[{key:"convert",value:function(t){return t.map(function(t){return new w(t)}).sort(function(t,e){return e.closeTime-t.closeTime})}}]),e}(o["a"]),j=n("4670");(function(t){t[t["New"]=0]="New",t[t["Hit"]=1]="Hit",t[t["Double"]=2]="Double",t[t["Insure"]=3]="Insure",t[t["Stand"]=4]="Stand",t[t["Surrender"]=5]="Surrender"})(p||(p={})),function(t){t[t["Active"]=101]="Active"}(g||(g={}));var S=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(i["a"])(this,Object(s["a"])(e).call(this,t.eos.network===y["a"].KYLIN?"godappblackj":"blackjack.e",t,e.ID)),n.historyTable=new O(t.eos,n.name),n.gameTable=new f(t.eos,n.name),n}return Object(u["a"])(e,t),Object(a["a"])(e,[{key:"init",value:function(){return this.pushAction("init",{})}},{key:"setGlobal",value:function(t,e){return this.pushAction("setglobal",{key:t,value:e})}},{key:"play",value:function(t,e){return this.transfer(t,p.New+","+e+",")}},{key:"hit",value:function(){return this.playerAction(p.Hit)}},{key:"stand",value:function(){return this.playerAction(p.Stand)}},{key:"surrender",value:function(){return this.playerAction(p.Surrender)}},{key:"hardClose",value:function(t,e){return this.pushAction("hardclose",{game_id:t,reason:e})}},{key:"clearGames",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9999;return this.pushAction("cleargames",{num:t})}},{key:"close",value:function(t){return this.pushAction("close",{game_id:t})}},{key:"playerAction",value:function(t){return this.pushAction("playeraction",{player:this.accountName(),action:t})}}]),e}(j["b"]);S.CONTRACT=v.NETWORK===y["a"].KYLIN?"godappblackj":"blackjack.e",S.ID=2;var T,P=n("3797");n.d(e,"a",function(){return A}),function(t){t[t["Initializing"]=0]="Initializing",t[t["NotLoading"]=1]="NotLoading",t[t["Shuffling"]=2]="Shuffling",t[t["Standing"]=3]="Standing",t[t["Hitting"]=4]="Hitting"}(T||(T={}));var A=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(i["a"])(this,Object(s["a"])(e).call(this,t)),n.normalTicker=void 0,n.myGameTicker=void 0,n.bankCardTicker=void 0,n.gameGlobals=void 0,n.history=[],n.historyLoading=!0,n.isFirstLoad=!0,n.game=new d(void 0),n.lastId=-1,n.referer="",n.loadingStatus=T.Initializing,n.contract=new S(n.house),n}return Object(u["a"])(e,t),Object(a["a"])(e,[{key:"initialize",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.referer=Object(h["e"])(e)?e:"",this.startAllTick(),this.startGetMyGame(0);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"hasStartGame",value:function(){return this.game.id>0&&this.game.status===l["b"].Active}},{key:"destroy",value:function(){this.stopAllTick()}},{key:"loadMyGame",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.eos.loggedIn()){t.next=3;break}throw this.loadingStatus=T.NotLoading,new Error("Not logged in");case 3:return t.next=5,this.contract.gameTable.getById(this.eos.account.name);case 5:if(e=t.sent,!Object(h["e"])(e)){t.next=23;break}if((e.status!==this.game.status||e.playerCards.length!==this.game.playerCards.length)&&e.status!==l["b"].Stood&&0!==e.playerCards.length){t.next=9;break}throw new Error("Waiting for more game update");case 9:if(e.status!==l["b"].Close){t.next=18;break}if(e.id!==this.lastId){t.next=14;break}throw new Error("Waiting for more game update");case 14:this.lastId=e.id;case 15:this.isFirstLoad||this.animateBankCards(e),t.next=20;break;case 18:this.game=e,this.loadingStatus=T.NotLoading;case 20:this.isFirstLoad=!1,t.next=24;break;case 23:this.loadingStatus=T.NotLoading;case 24:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"animateBankCards",value:function(t){var e=this;this.game.resultUpdate(t)?(Object(h["e"])(this.bankCardTicker)&&clearTimeout(this.bankCardTicker),this.bankCardTicker=setTimeout(Object(r["a"])(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:e.animateBankCards(t);case 1:case"end":return n.stop()}},n,this)})),1e3)):(this.game=t,this.loadingStatus=T.NotLoading)}},{key:"loadHistory",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.contract.historyTable.readAll();case 2:this.history=t.sent,this.historyLoading=!1;case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"reset",value:function(){this.game=new d(void 0)}},{key:"startGetMyGame",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,a=this,i=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:2e3,n=i.length>1&&void 0!==i[1]?i[1]:"",Object(h["d"])(n)){t.next=5;break}return t.next=5,this.eos.waitUntilImmutable(n);case 5:this.stopGetMyGame(),this.myGameTicker=setTimeout(Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.loadMyGame();case 3:a.stopGetMyGame(),a.loadingStatus=T.NotLoading,a.betControl.finishBet(-1),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),a.startGetMyGame(500,"");case 11:case"end":return t.stop()}},t,this,[[0,8]])})),e);case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"stopGetMyGame",value:function(){null!==this.myGameTicker&&(clearTimeout(this.myGameTicker),this.myGameTicker=null)}},{key:"startAllTick",value:function(){var t=this;this.stopAllTick(),this.loadHistory(),this.normalTicker=setTimeout(function(){t.startAllTick()},3e3)}},{key:"stopAllTick",value:function(){null!==this.normalTicker&&(clearTimeout(this.normalTicker),this.normalTicker=null)}},{key:"makeAction",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e,n){var r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loadingStatus=n,t.next=4,e();case 4:return r=t.sent,this.startGetMyGame(0,r.id),t.abrupt("return",r);case 9:t.prev=9,t.t0=t["catch"](0),this.loadingStatus=T.NotLoading;case 12:case"end":return t.stop()}},t,this,[[0,9]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"hit",value:function(){var t=this;return this.makeAction(function(){return t.contract.hit()},T.Hitting)}},{key:"stand",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",this.makeAction(function(){return e.contract.stand()},T.Standing));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"surrender",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",this.makeAction(function(){return e.contract.surrender()},T.Standing));case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"isWaitingForAction",value:function(){return this.loadingStatus!==T.NotLoading}},{key:"isStanding",value:function(){return this.loadingStatus===T.Standing}},{key:"isHitting",value:function(){return this.loadingStatus===T.Hitting}},{key:"isShuffling",value:function(){return this.loadingStatus===T.Shuffling}},{key:"betText",value:function(){return"Play"}},{key:"canMakeBet",value:function(){return this.game.status!==l["b"].Active}},{key:"makeBet",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.contract.play(new k["a"](e,b["a"].EOS),this.referer);case 2:return n=t.sent,this.reset(),this.startGetMyGame(0,n.id),t.abrupt("return",n);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}(P["a"])},bff1:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"c",function(){return a}),n.d(e,"a",function(){return h});n("ac4d"),n("8a81"),n("ac6a"),n("c5f6"),n("6b54"),n("28a5");var r,a,i=n("d4ec"),s=n("bee2"),u=n("56b9"),c=n("47bb"),o=n("f370"),l=n("abdf");(function(t){t[t["Unknown"]=0]="Unknown",t[t["Active"]=1]="Active",t[t["Stood"]=2]="Stood",t[t["Close"]=3]="Close"})(r||(r={})),function(t){t[t["Unknown"]=0]="Unknown",t[t["Surrender"]=1]="Surrender",t[t["Win"]=2]="Win",t[t["Lose"]=3]="Lose",t[t["Push"]=4]="Push"}(a||(a={}));var h=function(){function t(e){Object(i["a"])(this,t),Object(o["e"])(e)?(this.id=e.id,this.closeTime=parseInt(e.close_time,10),this.playerCards=e.player_cards.map(function(t){return new u["a"](t)}),this.bankerCards=e.banker_cards.map(function(t){return new u["a"](t)}),this.player=e.player,this.bet=c["a"].fromString(e.bet),this.insured=e.insured,this.result=e.result,this.status=e.status,this.bankerPoints=t.calculatePoints(this.bankerCards),this.playerPoints=t.calculatePoints(this.playerCards)):(this.id=0,this.closeTime=0,this.player="",this.playerCards=[],this.bankerCards=[],this.bet=new c["a"](0,l["a"].EOS),this.insured=!1,this.result=a.Unknown,this.status=r.Unknown,this.bankerPoints=0,this.playerPoints=0)}return Object(s["a"])(t,[{key:"resultUpdate",value:function(e){if(this.playerCards.length<e.playerCards.length){for(var n=this.playerCards.length;n<e.playerCards.length;n++)this.playerCards.push(e.playerCards[n]);this.playerPoints=t.calculatePoints(this.playerCards)}return this.bankerCards.length<e.bankerCards.length&&(this.bankerCards.push(e.bankerCards[this.bankerCards.length]),this.bankerPoints=t.calculatePoints(this.bankerCards),!0)}},{key:"isBankerBusted",value:function(){return this.bankerPoints>t.MAX_POINTS}},{key:"isPlayerBusted",value:function(){return this.playerPoints>t.MAX_POINTS}},{key:"isBankerBlackjack",value:function(){return this.bankerPoints===t.MAX_POINTS&&2===this.bankerCards.length}},{key:"isPlayerBlackjack",value:function(){return this.playerPoints===t.MAX_POINTS&&2===this.playerCards.length}},{key:"getProfit",value:function(t){var e=this.bet.toString().split(" ")[0];switch(t){case 1:return new c["a"](2.5*Number(e),l["a"].EOS);case 2:return new c["a"](2*Number(e),l["a"].EOS);case 3:return new c["a"](.5*Number(e),l["a"].EOS);case 4:return this.bet;default:return new c["a"](1*Number(e),l["a"].EOS)}}},{key:"isWin",value:function(){return this.result===a.Win}},{key:"isLose",value:function(){return this.result===a.Lose}},{key:"isPush",value:function(){return this.result===a.Push}},{key:"isSurrender",value:function(){return this.result===a.Surrender}},{key:"hasResult",value:function(){return this.result!==a.Unknown&&this.status===r.Close}},{key:"canSurrender",value:function(){return 2===this.playerCards.length}}],[{key:"calculatePoints",value:function(t){var e=0,n=0,r=!0,a=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value,o=Math.min(c.value,10);1===c.value&&n++,e+=o}}catch(h){a=!0,i=h}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}for(var l=0;l<n;l++){if(e+10>21)return e;e+=10}return e}}]),t}();h.MAX_POINTS=21}}]);